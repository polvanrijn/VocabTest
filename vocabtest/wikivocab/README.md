# ğŸ“– WikiVocab
#### Generative vocabulary test for 60 languages, supporting > 10 writing systems
**TD;DR**: Vocabulary tests are useful to assess if someone is a native speaker of a language. This repository allows to quickly test vocabulary knowledge for 60 lanugages. ğŸ“ [Try the test yourself](https://polvanrijn.github.io/WikiVocab/index.html)
*********

```
TODO put on Arxiv
```
[![arXiv](https://img.shields.io/badge/arXiv-2203.15379-b31b1b.svg)](https://arxiv.org/abs/2203.15379)

> **Abstract**
>
> TODO


## Data
| Language                         | ISO  | Size | Dictionary | Demo | Word lists |
|----------------------------------| ---- | ---- | ---------- | ---- | ---------- |
| Afrikaans ğŸ‡¿ğŸ‡¦                   | af   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Arabic (many countries)          | ar   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Belarussian ğŸ‡§ğŸ‡¾                 | be   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Bulgarian ğŸ‡§ğŸ‡¬                   | bg   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Catalan ğŸ‡ªğŸ‡¸                     | ca   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Czech ğŸ‡¨ğŸ‡¿                       | cs   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Welsh ğŸ‡¬ğŸ‡§                       | cy   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Danish ğŸ‡©ğŸ‡°                      | da   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| German ğŸ‡©ğŸ‡ªğŸ‡¨ğŸ‡­ğŸ‡¦ğŸ‡¹              | de   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Greek ğŸ‡¬ğŸ‡·                       | el   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| English (many countries)         | en   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Spanish (many countries)         | es   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Estionian ğŸ‡ªğŸ‡ª                   | et   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Basque ğŸ‡ªğŸ‡¸                      | eu   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Persian ğŸ‡®ğŸ‡·ğŸ‡¦ğŸ‡«ğŸ‡¹ğŸ‡¯             | fa   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Finnish ğŸ‡«ğŸ‡®                     | fi   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Faroese ğŸ‡©ğŸ‡°                     | fo   | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| French (many countries)          | fr   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Irish ğŸ‡®ğŸ‡ª                       | ga   | âœ…    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Gaelic (Scottish) ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿ | gd   | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Galician ğŸ‡ªğŸ‡¸                    | gl   | âœ…    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Gothic (dead)                    | got  | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Hebrew ğŸ‡®ğŸ‡±                      | he   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Hindi ğŸ‡®ğŸ‡³                       | hi   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Croatian ğŸ‡­ğŸ‡·                    | hr   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Hungarian ğŸ‡­ğŸ‡º                   | hu   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Armenian ğŸ‡¦ğŸ‡²                    | hy   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Western Armenian                 | hyw  | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Indonesia ğŸ‡®ğŸ‡©                   | id   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Icelandic ğŸ‡®ğŸ‡¸                   | is   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Italian ğŸ‡®ğŸ‡¹                     | it   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Japanese ğŸ‡¯ğŸ‡µ                    | ja   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Korean ğŸ‡°ğŸ‡·                      | ko   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Latin (dead)                     | la   | âœ…    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Lithuania ğŸ‡±ğŸ‡¹                   | lt   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Latvian ğŸ‡±ğŸ‡»                     | lv   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Marathi ğŸ‡®ğŸ‡³                     | mr   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Maltese  ğŸ‡²ğŸ‡¹                    | mt   | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Dutch ğŸ‡³ğŸ‡±ğŸ‡§ğŸ‡ª                   | nl   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Norwegian Nynorsk ğŸ‡³ğŸ‡´           | nn   | âœ…    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Norwegian BokmÃ¥l ğŸ‡³ğŸ‡´            | no   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Polish ğŸ‡µğŸ‡±                      | pl   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Portuguese ğŸ‡µğŸ‡¹                  | pt   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Romanian ğŸ‡·ğŸ‡´                    | ro   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Russian ğŸ‡·ğŸ‡º                     | ru   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Sanskrit ğŸ‡®ğŸ‡³                    | sa   | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Northern Sami ğŸ‡³ğŸ‡´               | se   | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Slovak ğŸ‡¸ğŸ‡°                      | sk   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Slovenian ğŸ‡¸ğŸ‡®                   | sl   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Serbian ğŸ‡·ğŸ‡¸                     | sr   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Swedish ğŸ‡¸ğŸ‡ª                     | sv   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Tamil ğŸ‡®ğŸ‡³ğŸ‡±ğŸ‡°ğŸ‡¸ğŸ‡¬               | ta   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Telugu ğŸ‡®ğŸ‡³                      | te   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Turkish ğŸ‡¹ğŸ‡·                     | tr   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Uyghur ğŸ‡¨ğŸ‡³                      | ug   | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Ukranian ğŸ‡ºğŸ‡¦                    | uk   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Urdu ğŸ‡µğŸ‡°ğŸ‡®ğŸ‡³                    | ur   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Vietnamese ğŸ‡»ğŸ‡³                  | vi   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |
| Wolof ğŸ‡¸ğŸ‡³                       | wo   | âš ï¸    | âš ï¸          | ğŸ”—    | ğŸ“„          |
| Chinese ğŸ‡¨ğŸ‡³                     | zh   | âœ…    | âœ…          | ğŸ”—    | ğŸ“„          |

*Legend: **Size** âœ… = collected â‰¥ 5 million valid tokens, âš ï¸ = less tokens are collected, indicating the frequency estimates might be irreliable. **Dictionary** âœ… = all words are spellchecked, âš ï¸ = less than 35% of the tokens could be spellchecked; we include all words without spellchecking.*

## Setup
Clone the repository and install the requirements:
```shell
git clone https://github.com/polvanrijn/WikiVocab
cd WikiVocab
REPO_DIR=$(pwd)
pip install -r requirements.txt
```

<details>
<summary><b>Optionally: Install dictionaries</b></summary>

Make sure you either have `hunspell` or `myspell` installed.
```shell
DIR_DICT = ~/.config/enchant/hunspell # if you use hunspell
DIR_DICT = ~/.config/enchant/myspell # if you use myspell
mkdir -p $DIR_DICT
```

Download the Libreoffice dictionaries:
```shell
cd $DIR_DICT
git clone https://github.com/LibreOffice/dictionaries
find dictionaries/ -type f -name "*.dic" -exec mv -i {} .  \;
find dictionaries/ -type f -name "*.aff" -exec mv -i {} .  \;
rm -Rf dictionaries/
```

Manually install missing dictionaries:
```shell
# Manually install dictionaries
function get_dictionary() {
  f="$(basename -- $1)"
  wget $1 --no-check-certificate
  unzip $f "*.dic" "*.aff"
  rm -f $f
}

# Urdu
get_dictionary https://versaweb.dl.sourceforge.net/project/aoo-extensions/2536/1/dict-ur.oxt

# Western Armenian
get_dictionary https://master.dl.sourceforge.net/project/aoo-extensions/4841/0/hy_am_western-1.0.oxt

# Galician
get_dictionary https://extensions.libreoffice.org/assets/do wnloads/z/corrector-18-07-para-galego.oxt

# Welsh
get_dictionary https://master.dl.sourceforge.net/project/aoo-extensions/1583/1/geiriadur-cy.oxt
mv dictionaries/* .
rm -Rf dictionaries/

# Belarusian
get_dictionary https://extensions.libreoffice.org/assets/downloads/z/dict-be-0-58.oxt

# Marathi
get_dictionary https://extensions.libreoffice.org/assets/downloads/73/1662621066/mr_IN-v8.oxt
mv dicts/* .
rm -Rf dicts/
```

Check all dictionaries are installed:
```shell
python3 -c "import enchant
broker = enchant.Broker()
print(sorted(list(set([lang.split('_')[0] for lang in broker.list_languages()]))))"
```
</details>

<details>
<summary><b>Optionally: Install FastText</b></summary>

```shell
cd $REPO_DIR
git clone https://github.com/facebookresearch/fastText.git
cd fastText
pip3 install .
wget https://dl.fbaipublicfiles.com/fasttext/supervised-models/lid.176.bin
cd ..
```
</details>

<details>
<summary><b>Optionally: Install local UDPipe</b></summary>

Install tensorflow:
```shell
pip install tensorflow
```

Make sure GPU is available:
```shell
python3 -c "import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))"
```

Install UDPipe:
```shell
cd $REPO_DIR
git clone https://github.com/ufal/udpipe
cd udpipe
git checkout udpipe-2
git clone https://github.com/ufal/wembedding_service
pip install .
```

Download the models
```shell
curl --remote-name-all https://lindat.mff.cuni.cz/repository/xmlui/bitstream/handle/11234/1-4804{/udpipe2-ud-2.10-220711.tar.gz}
tar -xvf udpipe2-ud-2.10-220711.tar.gz
rm udpipe2-ud-2.10-220711.tar.gz
```

I had to make one change to the code to make it work locally. Change line 375 in `udpipe2_server.py` to:
```python
if not hasattr(socket, 'SO_REUSEPORT'):
     socket.SO_REUSEPORT = 15
```
</details>

## Running
The full pipeline consists of three main parts:
- Extract and collect text
- Create and filter vocabulary
- Create pseudowords

### Extract and collect texts
Here we use the longest Wikipedia articles from a given language, but you could have taken any other large text corpus (ğŸ‘‰ read the paper to find out why we took Wikipedia). Each token is lemmatized and POS-tagged using UDPipe 2. For spellchecking we used FastText and manually installed dictionaries.

```shell
LANG=de # language code
python download_articles.py --language $LANG
python process_articles.py --language $LANG
```

### Create and filter vocabulary
Each processed article is stored as a single json file. We first merge the single processed articles into one file (our vocabulary). We now apply various filter the vocabulary, e.g. only include spell-checked nouns (see paper for all details).

```shell
python create_vocabulary.py --language $LANG
python filter_vocabulary.py --language $LANG
```

### Create pseudowords
From the curated vocabulary we can compute conditional probabilities of the n-grams (default: 5-grams). We can now sample pseudowords from the conditional probabilities of the n-grams. Once a pseudoword is created, we apply some filters. For example, the pseudoword may not occur in the vocabulary. The sampling speed depends on the language (e.g., some languages tend to mainly produce pseudowords which are already in the vocabulary). We stop the sampling after 8 hours, which gives sufficient (> 500) pseudowords. We pair each pseudoword with its closest real word.

```shell
python create_pseudowords.py --language $LANG # default is 5-grams
python pair_pseudowords.py --language $LANG
```

Setup GIZA++
```shell
git clone https://github.com/moses-smt/giza-pp
cd giza-pp
make
cp GIZA++-v2/GIZA++ $HOME/bin/
cp GIZA++-v2/plain2snt.out $HOME/bin/
cp GIZA++-v2/snt2cooc.out $HOME/bin/
cp GIZA++-v2/snt2plain.out $HOME/bin/
cp GIZA++-v2/trainGIZA++.sh $HOME/bin/
cp mkcls-v2/mkcls $HOME/bin/
```

### Citation
```
# TODO
```